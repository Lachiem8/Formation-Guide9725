    };

    function getRowCount(count) {
      if (count > 194) return 11;
      if (count >= 194) return 11;
      if (count >= 172) return 10;
      if (count >= 140) return 9;
      if (count >= 101) return 8;
      if (count >= 80) return 7;
      if (count >= 66) return 6;
      if (count >= 45) return 5;
      return null;
    }

    function calculateFormation() {
      const count = parseInt(document.getElementById('studentCount').value);
      const resultEl = document.getElementById('result');

      if (!count) {
        resultEl.innerText = 'Please enter a valid number';
        return;
      }

      if (count <= 8) {
        resultEl.innerHTML = `<span class="underline">All Standing</span>`;
        return;
      }

      if (predefinedFormations[count]) {
        const formation = predefinedFormations[count];
        resultEl.innerHTML = `<span class="underline">${formation.length} Rows</span>\nFormation: ${formation.join(' - ')}`;
        return;
      }

      const rowCount = getRowCount(count);
      if (!rowCount) {
        resultEl.innerText = 'Please enter a number between 9 and 161+';
        return;
      }

      let avg = count / rowCount;
      let avgDisplay = avg.toFixed(2);
      let high = Math.round(avg);
      let low = high - 1;
      let formation = [];

      for (let i = 0; i < rowCount; i++) {
        formation.push(i % 2 === 0 ? high : low);
      }

      let total = formation.reduce((a, b) => a + b, 0);
      let scanIns = count - total;

      while (scanIns < 0 && high > 1) {
        high -= 1;
        low = high - 1;
        formation = [];
        for (let i = 0; i < rowCount; i++) {
          formation.push(i % 2 === 0 ? high : low);
        }
        total = formation.reduce((a, b) => a + b, 0);
        scanIns = count - total;
      }

      resultEl.innerHTML = `<span class="underline">${rowCount} Rows</span>\nFormation: ${formation.join(' - ')}\nScan In(s): ${scanIns}\nAverage per row: ${avgDisplay}`;
    }

    // Scroll logic to prevent mobile keyboard bump
    window.scrollTo(0, 0);
    let userManuallyScrolled = false;

    window.addEventListener('scroll', () => {
      userManuallyScrolled = true;
    });

    const scrollInterval = setInterval(() => {
      if (!userManuallyScrolled) {
        window.scrollTo(0, 0);
      } else {
        clearInterval(scrollInterval);
      }
    }, 100);

    const input = document.getElementById('studentCount');
    input.addEventListener('focus', () => {
      userManuallyScrolled = true;
    });
    input.addEventListener('blur', () => {
      setTimeout(() => {
        window.scrollTo(0, 0);
        userManuallyScrolled = false;
      }, 100);
    });
  </script>
</body>

